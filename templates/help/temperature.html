<!-- templates/help/temperature.html -->
{% extends "base.html" %}

{% block title %}Temperature Parameter Guide - Cinematch{% endblock %}

{% block extra_head %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
    .temp-gauge {
        width: 200px;
        height: 200px;
        position: relative;
        margin: 0 auto;
    }
    .temp-examples {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-gray-900 to-black">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <a href="{{ url_for('help.help_center') }}" class="text-blue-400 hover:text-blue-300 mb-4 inline-block">
            ‚Üê Back to Help Center
        </a>
        
        <h1 class="text-4xl font-bold mb-8 bg-gradient-to-r from-orange-400 to-red-600 bg-clip-text text-transparent">
            Understanding Temperature
        </h1>
        
        <!-- Interactive Temperature Demo -->
        <div class="bg-gray-800 rounded-lg p-8 mb-8">
            <h2 class="text-2xl font-semibold mb-6">Interactive Temperature Explorer</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <div class="temp-gauge mb-6">
                        <canvas id="tempGauge"></canvas>
                        <div class="text-center mt-4">
                            <span class="text-3xl font-bold" id="tempDisplay">0.7</span>
                        </div>
                    </div>
                    
                    <div class="slider-container bg-gray-700 p-4 rounded">
                        <input type="range" id="tempSlider" min="0" max="20" value="7" 
                               class="w-full" onchange="updateTemperature(this.value)">
                        <div class="flex justify-between text-xs text-gray-400 mt-2">
                            <span>0.0 (Deterministic)</span>
                            <span>1.0 (Creative)</span>
                            <span>2.0 (Chaotic)</span>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-lg font-medium mb-4">Response Characteristics</h3>
                    <div id="tempCharacteristics" class="space-y-3">
                        <!-- Dynamic characteristics will be inserted here -->
                    </div>
                </div>
            </div>
            
            <!-- Live Examples -->
            <div class="mt-8">
                <h3 class="text-lg font-medium mb-4">Live Response Examples</h3>
                <div class="bg-gray-900 rounded p-4">
                    <p class="text-sm text-gray-400 mb-2">Prompt: "Recommend a sci-fi movie"</p>
                    <div id="tempExamples" class="temp-examples mt-4">
                        <!-- Dynamic examples will be inserted here -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Temperature Scale Visualization -->
        <div class="bg-gray-800 rounded-lg p-8 mb-8">
            <h2 class="text-2xl font-semibold mb-6">Temperature Scale</h2>
            
            <div class="relative">
                <div class="h-16 bg-gradient-to-r from-blue-600 via-yellow-500 to-red-600 rounded-lg"></div>
                <div class="absolute inset-0 flex items-center justify-between px-4">
                    <div class="text-center">
                        <div class="text-2xl">üßä</div>
                        <p class="text-xs mt-1">Cold (0.0)</p>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl">üå°Ô∏è</div>
                        <p class="text-xs mt-1">Balanced (0.7)</p>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl">üî•</div>
                        <p class="text-xs mt-1">Hot (2.0)</p>
                    </div>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-8">
                <div class="bg-blue-900/30 border border-blue-600 rounded p-4">
                    <h3 class="font-semibold text-blue-400 mb-2">Low Temperature (0.0 - 0.3)</h3>
                    <ul class="text-sm text-gray-300 space-y-1">
                        <li>‚Ä¢ Highly predictable</li>
                        <li>‚Ä¢ Factual and consistent</li>
                        <li>‚Ä¢ Minimal variation</li>
                        <li>‚Ä¢ Best for: Specific searches</li>
                    </ul>
                    <div class="mt-3 p-2 bg-gray-900 rounded">
                        <code class="text-xs">temp=0.1</code>
                        <p class="text-xs text-gray-400 mt-1">"The Terminator is a sci-fi action film"</p>
                    </div>
                </div>
                
                <div class="bg-yellow-900/30 border border-yellow-600 rounded p-4">
                    <h3 class="font-semibold text-yellow-400 mb-2">Medium Temperature (0.4 - 0.8)</h3>
                    <ul class="text-sm text-gray-300 space-y-1">
                        <li>‚Ä¢ Balanced creativity</li>
                        <li>‚Ä¢ Natural variation</li>
                        <li>‚Ä¢ Coherent responses</li>
                        <li>‚Ä¢ Best for: General use</li>
                    </ul>
                    <div class="mt-3 p-2 bg-gray-900 rounded">
                        <code class="text-xs">temp=0.7</code>
                        <p class="text-xs text-gray-400 mt-1">"You might enjoy The Terminator, a thrilling sci-fi classic"</p>
                    </div>
                </div>
                
                <div class="bg-red-900/30 border border-red-600 rounded p-4">
                    <h3 class="font-semibold text-red-400 mb-2">High Temperature (0.9 - 2.0)</h3>
                    <ul class="text-sm text-gray-300 space-y-1">
                        <li>‚Ä¢ Highly creative</li>
                        <li>‚Ä¢ Unexpected responses</li>
                        <li>‚Ä¢ May lack coherence</li>
                        <li>‚Ä¢ Best for: Brainstorming</li>
                    </ul>
                    <div class="mt-3 p-2 bg-gray-900 rounded">
                        <code class="text-xs">temp=1.5</code>
                        <p class="text-xs text-gray-400 mt-1">"Whoa! The Terminator - robots, explosions, and Arnold's iconic one-liners!"</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Mathematical Explanation -->
        <div class="bg-gray-800 rounded-lg p-8 mb-8">
            <h2 class="text-2xl font-semibold mb-6">How Temperature Works</h2>
            
            <div class="bg-gray-900 rounded p-6 mb-6">
                <h3 class="text-lg font-medium mb-3">The Math Behind Temperature</h3>
                <p class="text-gray-300 mb-4">
                    Temperature modifies the probability distribution of the next word selection:
                </p>
                <div class="bg-black rounded p-4 font-mono text-sm">
                    <p class="text-green-400">P(word) = exp(logit/T) / Œ£ exp(logits/T)</p>
                    <p class="text-gray-500 mt-2">Where T is the temperature parameter</p>
                </div>
                <ul class="mt-4 text-sm text-gray-300 space-y-2">
                    <li>‚Ä¢ T ‚Üí 0: Approaches maximum probability (deterministic)</li>
                    <li>‚Ä¢ T = 1: Original distribution</li>
                    <li>‚Ä¢ T ‚Üí ‚àû: Approaches uniform distribution (random)</li>
                </ul>
            </div>
            
            <canvas id="probabilityChart" height="100"></canvas>
        </div>
        
        <!-- Practical Guide -->
        <div class="bg-gray-800 rounded-lg p-8">
            <h2 class="text-2xl font-semibold mb-6">Practical Temperature Guide</h2>
            
            <div class="space-y-4">
                <div class="bg-gray-700 rounded p-4">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-medium">Finding Specific Movies</h4>
                        <span class="bg-blue-600 px-2 py-1 rounded text-xs">temp: 0.1-0.3</span>
                    </div>
                    <p class="text-sm text-gray-300">
                        Use low temperature when you need precise, factual responses about specific movies.
                    </p>
                </div>
                
                <div class="bg-gray-700 rounded p-4">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-medium">General Recommendations</h4>
                        <span class="bg-yellow-600 px-2 py-1 rounded text-xs">temp: 0.6-0.8</span>
                    </div>
                    <p class="text-sm text-gray-300">
                        Default range for balanced, natural movie recommendations.
                    </p>
                </div>
                
                <div class="bg-gray-700 rounded p-4">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-medium">Creative Exploration</h4>
                        <span class="bg-red-600 px-2 py-1 rounded text-xs">temp: 0.9-1.2</span>
                    </div>
                    <p class="text-sm text-gray-300">
                        Higher temperature for discovering unexpected connections and unique recommendations.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Temperature gauge
const gaugeCanvas = document.getElementById('tempGauge');
const gaugeCtx = gaugeCanvas.getContext('2d');
gaugeCanvas.width = 200;
gaugeCanvas.height = 200;

function drawGauge(value) {
    gaugeCtx.clearRect(0, 0, 200, 200);
    
    // Draw arc
    const centerX = 100;
    const centerY = 100;
    const radius = 80;
    
    // Background arc
    gaugeCtx.beginPath();
    gaugeCtx.arc(centerX, centerY, radius, Math.PI * 0.75, Math.PI * 2.25);
    gaugeCtx.strokeStyle = '#4a5568';
    gaugeCtx.lineWidth = 20;
    gaugeCtx.stroke();
    
    // Value arc
    const angle = Math.PI * 0.75 + (value / 2) * Math.PI * 1.5;
    gaugeCtx.beginPath();
    gaugeCtx.arc(centerX, centerY, radius, Math.PI * 0.75, angle);
    
    // Gradient based on temperature
    const gradient = gaugeCtx.createLinearGradient(0, 0, 200, 0);
    if (value < 0.5) {
        gradient.addColorStop(0, '#3b82f6');
        gradient.addColorStop(1, '#60a5fa');
    } else if (value < 1) {
        gradient.addColorStop(0, '#f59e0b');
        gradient.addColorStop(1, '#fbbf24');
    } else {
        gradient.addColorStop(0, '#ef4444');
        gradient.addColorStop(1, '#f87171');
    }
    
    gaugeCtx.strokeStyle = gradient;
    gaugeCtx.lineWidth = 20;
    gaugeCtx.stroke();
}

function updateTemperature(value) {
    const temp = value / 10;
    document.getElementById('tempDisplay').textContent = temp.toFixed(1);
    drawGauge(temp);
    
    // Update characteristics
    const characteristics = document.getElementById('tempCharacteristics');
    let html = '';
    
    if (temp < 0.3) {
        html = `
            <div class="flex items-center space-x-2">
                <span class="text-2xl">üéØ</span>
                <span>Precision: <strong class="text-blue-400">Maximum</strong></span>
            </div>
            <div class="flex items-center space-x-2">
                <span class="text-2xl">üé®</span>
                <span>Creativity: <strong class="text-gray-500">Minimal</strong></span>
            </div>
            <div class="flex items-center space-x-2">
                <span class="text-2xl">üîÑ</span>
                <span>Variation: <strong class="text-gray-500">Very Low</strong></span>
            </div>
        `;
    } else if (temp < 0.8) {
        html = `
            <div class="flex items-center space-x-2">
                <span class="text-2xl">üéØ</span>
                <span>Precision: <strong class="text-yellow-400">Good</strong></span>
            </div>
            <div class="flex items-center space-x-2">
                <span class="text-2xl">üé®</span>
                <span>Creativity: <strong class="text-yellow-400">Balanced</strong></span>
            </div>
            <div class="flex items-center space-x-2">
                <span class="text-2xl">üîÑ</span>
                <span>Variation: <strong class="text-yellow-400">Natural</strong></span>
            </div>
        `;
    } else {
        html = `
            <div class="flex items-center space-x-2">
                <span class="text-2xl">üéØ</span>
                <span>Precision: <strong class="text-red-400">Variable</strong></span>
            </div>
            <div class="flex items-center space-x-2">
                <span class="text-2xl">üé®</span>
                <span>Creativity: <strong class="text-red-400">Maximum</strong></span>
            </div>
            <div class="flex items-center space-x-2">
                <span class="text-2xl">üîÑ</span>
                <span>Variation: <strong class="text-red-400">High</strong></span>
            </div>
        `;
    }
    
    characteristics.innerHTML = html;
    
    // Update examples
    updateExamples(temp);
}

function updateExamples(temp) {
    const examples = document.getElementById('tempExamples');
    let html = '';
    
    if (temp < 0.3) {
        html = `
            <div class="bg-gray-800 p-3 rounded">
                <p class="text-sm font-medium text-blue-400">Response 1:</p>
                <p class="text-sm">"I recommend Blade Runner 2049."</p>
            </div>
            <div class="bg-gray-800 p-3 rounded">
                <p class="text-sm font-medium text-blue-400">Response 2:</p>
                <p class="text-sm">"I recommend Blade Runner 2049."</p>
            </div>
            <div class="bg-gray-800 p-3 rounded">
                <p class="text-sm font-medium text-blue-400">Response 3:</p>
                <p class="text-sm">"I recommend Blade Runner 2049."</p>
            </div>
        `;
    } else if (temp < 0.8) {
        html = `
            <div class="bg-gray-800 p-3 rounded">
                <p class="text-sm font-medium text-yellow-400">Response 1:</p>
                <p class="text-sm">"You might enjoy Blade Runner 2049, a visually stunning sequel."</p>
            </div>
            <div class="bg-gray-800 p-3 rounded">
                <p class="text-sm font-medium text-yellow-400">Response 2:</p>
                <p class="text-sm">"I'd suggest checking out Arrival - thoughtful sci-fi at its best."</p>
            </div>
            <div class="bg-gray-800 p-3 rounded">
                <p class="text-sm font-medium text-yellow-400">Response 3:</p>
                <p class="text-sm">"Consider watching Ex Machina for a cerebral AI thriller."</p>
            </div>
        `;
    } else {
        html = `
            <div class="bg-gray-800 p-3 rounded">
                <p class="text-sm font-medium text-red-400">Response 1:</p>
                <p class="text-sm">"Oh wow, have you seen Moon? Sam Rockwell alone on the lunar surface!"</p>
            </div>
            <div class="bg-gray-800 p-3 rounded">
                <p class="text-sm font-medium text-red-400">Response 2:</p>
                <p class="text-sm">"Sci-fi? Let's talk Coherence - mind-bending dinner party chaos!"</p>
            </div>
            <div class="bg-gray-800 p-3 rounded">
                <p class="text-sm font-medium text-red-400">Response 3:</p>
                <p class="text-sm">"District 9! Aliens, action, and apartheid allegories - wild ride!"</p>
            </div>
        `;
    }
    
    examples.innerHTML = html;
}

// Probability distribution chart
const probCtx = document.getElementById('probabilityChart').getContext('2d');
const probChart = new Chart(probCtx, {
    type: 'line',
    data: {
        labels: ['Word 1', 'Word 2', 'Word 3', 'Word 4', 'Word 5'],
        datasets: [
            {
                label: 'T=0.1',
                data: [0.9, 0.08, 0.015, 0.004, 0.001],
                borderColor: '#3b82f6',
                tension: 0.4
            },
            {
                label: 'T=0.7',
                data: [0.4, 0.3, 0.15, 0.1, 0.05],
                borderColor: '#f59e0b',
                tension: 0.4
            },
            {
                label: 'T=1.5',
                data: [0.25, 0.22, 0.20, 0.18, 0.15],
                borderColor: '#ef4444',
                tension: 0.4
            }
        ]
    },
    options: {
        responsive: true,
        plugins: {
            title: {
                display: true,
                text: 'Probability Distribution at Different Temperatures'
            }
        },
        scales: {
            y: {
                beginAtZero: true,
                max: 1
            }
        }
    }
});

// Initialize
drawGauge(0.7);
updateTemperature(7);
</script>
{% endblock %}